post:
  operationId: api_v2_cases_{identifier}_iocs_post
  summary: Create an IOC
  tags:
    - IOCs
    - Beta
  requestBody:
    content:
      application/json:
        schema:
          type: object
          properties:
            data:
              type: object
              properties:
                ioc_description:
                  type: string
                  minLength: 1
                  description: 'A short description of the ioc. This will be the summary of the ioc.'
                  required: true 
                ioc_id:
                  type: number
                  description: 'A ioc reference'
                  required: true 
                ioc_misp:
                  description: 'Misp of ioc'
                ioc_tags:
                  type: string
                  description : 'Ioc tags'
                  required: true 
                ioc_tlp_id:
                  type: number
                  required: true 
                ioc_type:
                  type: number
                  required: true 
                ioc_type_id:
                  type: number
                  required: true 
                ioc_value:
                  type: string
                  minLength: 1
                  required: true 
                user_id:
                  type: number
                  required: true 
        examples:
           Valid request:
             value:
                 ioc_description: rewrw
                 ioc_id: 34
                 ioc_misp: null
                 ioc_tags: ''
                 ioc_tlp_id: 2
                 ioc_type: 1
                 ioc_type_id: 1
                 ioc_value: 8.8.8.8
                 user_id: 1
    responses:
      '201':
        description: Ioc successfully created
        content:
          application/json:
            schema:
              $ref: ../schemas/IOC.yaml
      '400':
          $ref: ../responses/GenericError.yaml
    description: 'Creates a new ioc.'
get:
  operationId: api_v2_cases_{identifier}_iocs_get
  summary: Get a paginated list of IOCs
  description: Returns a paginated list of IOCS. Accepts filters and sort query parameters.
  parameters:
    - $ref: ../parameters/query/page.yaml
    - $ref: ../parameters/query/perPage.yaml
    - $ref: ../parameters/query/orderBy.yaml
    - $ref: ../parameters/query/sortDirection.yaml
    - $ref: ../parameters/query/IOCTypeIdentifier.yaml
    - $ref: ../parameters/query/IOCType.yaml
    - $ref: ../parameters/query/IocTlpIdentifier.yaml
    - $ref: ../parameters/query/IocValue.yaml
    - $ref: ../parameters/query/IocDescription.yaml
    - $ref: ../parameters/query/IocTags.yaml
  responses:
    '200':
      description: Paginated list of IOCS
      content:
        application/json:
          schema:
            $ref: ../schemas/IOCs.yaml
  tags:
    - IOCs
    - Beta
